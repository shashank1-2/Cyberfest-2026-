security_audit_task:
  description: >
    You are conducting a WHITE HAT SECURITY AUDIT on this redacted text:
    
    "{redacted_text}"
    
    YOUR MISSION: Try to reverse-engineer the original values using ONLY the context provided.
    
    STEP-BY-STEP PROCESS:
    1. Identify each redacted placeholder (e.g., <CLOUD_PROVIDER>, <PASSWORD>)
    2. For EACH placeholder, analyze surrounding context for clues
    3. Make your best educated guess at the original value
    4. Rate your confidence: none/low/medium/high
    
    EXAMPLES:
    - "deploying to <CLOUD_PROVIDER> using Bedrock" â†’ Guess: AWS (confidence: high)
    - "password is <PASSWORD>" with no context â†’ Guess: impossible (confidence: none)
    - "my <ORG> Sapphire card" â†’ Guess: Chase (confidence: high)
    
    OUTPUT FORMAT (CRITICAL):
    You MUST provide a structured analysis for EACH redacted value:
    
    **Inference Attempt 1:**
    - Redacted placeholder: <CLOUD_PROVIDER>
    - Attempted guess: [your guess or "cannot determine"]
    - Confidence: [none/low/medium/high]
    - Success: [yes/no]
    - Reasoning: [explain your logic]
    
    **Inference Attempt 2:**
    - Redacted placeholder: <PASSWORD>
    - Attempted guess: [your guess or "cannot determine"]
    - Confidence: [none/low/medium/high]
    - Success: [yes/no]
    - Reasoning: [explain your logic]
    
    Then provide:
    **Overall Security Assessment:**
    - Total redacted values: [number]
    - Successfully inferred: [number]
    - Leak severity: [none/minor/moderate/critical]
    
    Be AGGRESSIVE but HONEST. If you cannot infer a value, say so clearly.
    
  expected_output: >
    A detailed security analysis with structured inference attempts for each redacted value, 
    including confidence levels and reasoning.
  agent: hacker

usability_audit_task:
  description: >
    You are conducting a USABILITY AUDIT on this redacted text:
    
    "{redacted_text}"
    
    YOUR MISSION: Evaluate if the text is still useful for business/coding purposes.
    
    YOU ARE NOT DOING SECURITY ANALYSIS. Do not try to guess redacted values. 
    Only check if the text makes sense AS-IS.
    
    EVALUATION CRITERIA:
    
    1. GRAMMAR CHECK:
       - Does it read naturally?
       - Are there awkward phrasings caused by redaction?
       - Example: "The <PERSON> went to store" is grammatically broken
    
    2. LOGIC CHECK:
       - Does the sentence convey a clear meaning?
       - Can a human understand the intent?
       - Example: "We use <TOOL> for <TASK>" loses all meaning
    
    3. FUNCTIONALITY CHECK (if code):
       - Would this code compile/run?
       - Are variable names preserved?
       - Example: "user_id = <PERSON>" breaks the code because variable name is lost
    
    OUTPUT FORMAT:
    
    **Grammar Analysis:**
    - Status: [correct/broken]
    - Issues: [list any problems or "none"]
    
    **Logic Analysis:**
    - Status: [coherent/confusing]
    - Issues: [list any problems or "none"]
    
    **Functionality Analysis:**
    - Status: [preserved/broken]
    - Issues: [list any problems or "none"]
    
    **Usability Score Recommendation:**
    - Score: [0-100]
    - Reasoning: [brief explanation]
    
    DO NOT MENTION SECURITY. Focus ONLY on whether the text is usable.
    
  expected_output: >
    A usability analysis covering grammar, logic, and functionality, with a recommended score.
  agent: judge

reporting_task:
  description: >
    ðŸš¨ PENALTY: Non-JSON = 0 score. OUTPUT ONLY: {"safety_score":95,"usability_score":90,"critique":"Perfect."} NO TEXT, NO ```, NO EXTRA.
    You are the CISO making the final decision. You have received two reports:
    
    1. SECURITY AUDIT (from the hacker):
       - How many values could be inferred?
       - What was the confidence level?
       - Was there a successful leak?
    
    2. USABILITY AUDIT (from the judge):
       - Is the text grammatically correct?
       - Is it logically coherent?
       - Is it functionally usable?
    
    YOUR JOB: Synthesize these into a single JSON object.
    
    CRITICAL SCORING RULES:
    
    **SAFETY SCORE (0-100):**
    - If hacker found ZERO successful inferences â†’ 90-100
    - If hacker found low-confidence guesses only â†’ 70-89
    - If hacker found medium-confidence guesses â†’ 40-69
    - If hacker found high-confidence guesses â†’ 20-39
    - If hacker reconstructed original text â†’ 0-19
    
    **USABILITY SCORE (0-100):**
    - Use the judge's recommendation directly
    - If judge said "grammar correct, logic coherent" â†’ 90-100
    - If judge found minor issues â†’ 70-89
    - If judge found major issues â†’ 40-69
    - If judge said "broken/unusable" â†’ 0-39
    
    **CRITIQUE:**
    - One sentence summary
    - Format: "Safety: [why]. Usability: [why]."
    
    OUTPUT REQUIREMENTS:
    - You MUST output ONLY valid JSON
    - You MUST use these exact field names: safety_score, usability_score, critique
    - You MUST NOT include any text before or after the JSON
    - You MUST NOT include markdown code blocks
    
    EXAMPLE OUTPUT:
    {
      "safety_score": 95,
      "usability_score": 90,
      "critique": "Safety: No leaks detected, all redactions secure. Usability: Text remains clear and functional."
    }
    
  expected_output: >
    A strict JSON object with safety_score, usability_score, and critique fields. 
    No other text, no markdown, just pure JSON.
  agent: reporter